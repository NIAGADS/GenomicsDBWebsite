<?xml version="1.0" encoding="UTF-8"?>
<wdkModel>

    <querySet name="GwasDatasetAttributes" queryType="attribute" isCacheable="false">

        <defaultTestParamValues>
            <paramValue name="dataset_id">NG00027</paramValue>
        </defaultTestParamValues>

        <testRowCountSql>
      select count(*) from NIAGADS.ResourceAttributes
        </testRowCountSql>


        <!-- =============================================================== -->
        <!-- Basic Attributes -->
        <!-- =============================================================== -->

        <sqlQuery name="BasicAttributes">
            <column name="track"/>
            <column name="project_id"/>
            <column name="accession_link"/>
            <column name="niagads_accession"/>
            <column name="name"/>
            <column name="description"/>
            <column name="category"/>
            <column name="is_adsp"/>
            <column name="search_link"/>
            <sql>
                <![CDATA[
                        SELECT track,
                        '@PROJECT_ID@'::text AS project_id,
                        name || ' (' || attribution || ')' AS name,
                        description,
                        build_link_attribute(dataset_accession, '../dataset/') AS accession_link,
                        dataset_accession AS niagads_accession,
                        category,
                        build_link_attribute('Mine this dataset', '@NIAGADS_BASE_URL@' || '/' || '@WEBAPP@' || '/' ||
                         '@SHOW_GWAS_SEARCH@', '&' || 'gwas_accession=' || dataset_accession || '&' || 'gwas_dataset=' || track) AS search_link,
                        CASE WHEN dataset_accession LIKE '%ADSP%' THEN build_icon_attribute('ADSP', 'fa-check-square-o', 'red', NULL, true::text)::text ELSE NULL END AS is_adsp
                        FROM NIAGADS.TrackAttributes
                    ]]>
            </sql>
        </sqlQuery>
    </querySet>


  
</wdkModel>
